<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN>
             <html>
             <head>
                <title>Coverage - out/build/linux-debug-llvm/test/test-pars - [...]/lib/include/pars/ev/job.h</title>
                <link rel="stylesheet" type="text/css" href="llvmcov2html.css"/>
             </head>
             <body>
             <table width="100%" border="0" cellspacing="0" cellpadding="0">
             <tr><td class="title">Coverage Report</td></tr>
             <tr><td class="ruler"><img src="glass.png" width="3" height="3" alt=""/></td></tr>
             <tr>
             <td width="100%">
                <table cellpadding="1" border="0" width="100%">
                   <tr>
                      <td class="headerItem" width="20%">Command:</td>
                      <td class="headerValue" width="80%" colspan=6>out/build/linux-debug-llvm/test/test-pars</td>
        </tr>
                     <tr>
                     <td class="headerItem" width="20%">Date:</td>
                     <td class="headerValue" width="15%">Mon Jun  9 15:20:03 2025 </td>
                     <td width="5%"></td>
                     <td class="headerItem" width="20%">Instrumented&nbsp;lines:</td>
                     <td class="headerValue" width="10%">12</td>
                   </tr>
                   <tr>
                   <td class="headerItem" width="20%">Code&nbsp;covered:
                   <td class="headerValue" width="15%">0.0 %</td>
                   <td width="5%"></td>
                     <td class="headerItem" width="20%">Executed&nbsp;lines:</td>
                     <td class="headerValue" width="10%">0</td>
                   </tr>
                 </table>
               </td>
             </tr>
             <tr><td class="ruler"><img src="glass.png" width="3" height="3" alt=""/></td></tr>
           </table>
<pre class="source">
             : /*
             : Copyright (c) 2025 Giuseppe Roberti.
             : All rights reserved.
             : 
             : Redistribution and use in source and binary forms, with or without modification,
             : are permitted provided that the following conditions are met:
             : 
             : 1. Redistributions of source code must retain the above copyright notice, this
             : list of conditions and the following disclaimer.
             : 
             : 2. Redistributions in binary form must reproduce the above copyright notice,
             : this list of conditions and the following disclaimer in the documentation and/or
             : other materials provided with the distribution.
             : 
             : 3. Neither the name of the copyright holder nor the names of its contributors
             : may be used to endorse or promote products derived from this software without
             : specific prior written permission.
             : 
             : THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND
             : ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
             : WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
             : DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR
             : ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
             : (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
             : LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
             : ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
             : (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
             : SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
             : */
             : #pragma once
             : 
             : #include &quot;nngxx/msg.h&quot;
             : 
             : #include &quot;pars/ev/kind.h&quot;
             : #include &quot;pars/ev/metadata.h&quot;
             : #include &quot;pars/ev/serializer.h&quot;
             : #include &quot;pars/ev/spec.h&quot;
             : 
             : #include &lt;any&gt;
             : #include &lt;type_traits&gt;
             : 
             : namespace pars::ev
             : {
             : 
             : class job
             : {
             : public:
             :   job(std::size_t j_id, int s_id, std::size_t h, std::any ke)
             :     : id_m{j_id}
             :     , socket_id_m{s_id}
             :     , spec_hash_m{h}
             :     , event_kind_m{std::move(ke)}
             :   {
             :   }
             : 
             :   job(const job&amp;) = delete;
             : 
             :   job(job&amp;&amp;) = default;
             : 
             :   job&amp; operator=(const job&amp;) = delete;
             : 
             :   job&amp; operator=(job&amp;&amp; j) = default;
             : 
             :   template&lt;template&lt;typename&gt; typename kind_of, event_c event_t&gt;
             :     requires(!is_same_kind_v&lt;kind_of, received&gt; ||
             :              std::is_same_v&lt;event_t, nngxx::msg&gt;)
             :   kind_of&lt;event_t&gt; event()
             :   {
             :     return std::any_cast&lt;kind_of&lt;event_t&gt;&gt;(std::move(event_kind_m));
             :   }
             : 
             :   template&lt;template&lt;typename&gt; typename kind_of, event_c event_t&gt;
             :     requires(is_same_kind_v&lt;kind_of, received&gt; &amp;&amp;
             :              !std::is_same_v&lt;event_t, nngxx::msg&gt;)
             :   received&lt;event_t&gt; event()
             :   {
             :     // get the received&lt;nngxx::msg&gt;
             :     auto r = event&lt;received, nngxx::msg&gt;();
             : 
             :     auto&amp; md = r.md();
             : 
             :     // return a received&lt;event_t&gt;
             :     return received{
             :       serialize::to_event&lt;event_t&gt;(r.event()),
             :       metadata&lt;received, event_t&gt;{md.socket_id(), md.tool(), md.pipe()}};
             :   }
             : 
<span class="lineNoCov">      0 / 1 </span> :   [[nodiscard]] std::size_t id() const <span class="lineNoCov">{ return id_m; }</span>
             : 
<span class="lineNoCov">      0 / 1 </span> :   [[nodiscard]] int socket_id() const <span class="lineNoCov">{ return socket_id_m; }</span>
             : 
<span class="lineNoCov">      0 / 1 </span> :   [[nodiscard]] std::size_t spec_hash() const <span class="lineNoCov">{ return spec_hash_m; }</span>
             : 
             :   auto format_to(fmt::format_context&amp; ctx) const -&gt; decltype(ctx.out())
             :   {
<span class="lineNoCov">      0 / 1 </span> : <span class="lineNoCov">    return fmt::format_to(ctx.out(), &quot;spec:0x{:X}&quot;, spec_hash());</span>
             :   }
             : 
<span class="lineNoCov">      0 / 1 </span> :   void set_id(std::size_t id) <span class="lineNoCov">{ id_m = id; }</span>
             : 
             : private:
             :   std::size_t id_m;
             :   int socket_id_m;
             :   std::size_t spec_hash_m;
             :   std::any event_kind_m;
             : };
             : 
             : template&lt;template&lt;typename&gt; typename kind_of, event_c event_t&gt;
             :   requires kind_c&lt;kind_of&gt;
             : static std::size_t compute_spec_hash(const kind_of&lt;event_t&gt;&amp; ke)
             : {
<span class="lineNoCov">      0 / 1 </span> : <span class="lineNoCov">  if constexpr (std::is_same_v&lt;kind_of&lt;event_t&gt;, received&lt;nngxx::msg&gt;&gt;)</span>
<span class="lineNoCov">      0 / 1 </span> : <span class="lineNoCov">    return ke.msg_hash();</span>
<span class="lineNoCov">      0 / 1 </span> : <span class="lineNoCov">  else</span>
<span class="lineNoCov">      0 / 1 </span> : <span class="lineNoCov">    return spec&lt;kind_of&lt;event_t&gt;&gt;::hash;</span>
             : }
             : 
             : template&lt;template&lt;typename&gt; typename kind_of, event_c event_t&gt;
             :   requires kind_c&lt;kind_of&gt;
             : static job make_job(std::size_t j_id, kind_of&lt;event_t&gt; ke)
             : {
<span class="lineNoCov">      0 / 1 </span> : <span class="lineNoCov">  auto h = compute_spec_hash(ke);</span>
             : 
<span class="lineNoCov">      0 / 1 </span> : <span class="lineNoCov">  return job(j_id, ke.md().socket_id(), h,</span>
<span class="lineNoCov">      0 / 1 </span> : <span class="lineNoCov">             std::make_any&lt;kind_of&lt;event_t&gt;&gt;(std::move(ke)));</span>
             : }
             : 
             : } // namespace pars::ev
</pre>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
             <tr><td class="ruler"><img src="glass.png" width="3" height="3" alt=""/></td></tr>
             <tr><td class="versionInfo">Generated by: llvmcov2html</td></tr>
           </table>
           <br/>
           </body>
           </html>
